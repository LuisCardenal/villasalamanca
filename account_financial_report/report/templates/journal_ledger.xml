<?xml version="1.0" encoding="utf-8" ?>
<!-- Copyright 2018 ForgeFlow S.L.
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
<odoo>
    <template id="journal_ledger">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="account_financial_report.internal_layout">
                    <t t-call="account_financial_report.report_journal_ledger_base"/>
                </t>
            </t>
        </t>
    </template>
    <template id="report_journal_ledger_base">
        <!-- Saved flag fields into variables, used to define columns display -->
        <t t-set="foreign_currency" t-value="foreign_currency"/>
        <t t-set="filter_partner_ids" t-value="filter_partner_ids"/>
        <!-- Defines global variables used by internal layout -->
        <style>
            .act_as_table_personal {
            display: table !important;
            }
            .act_as_row_personal {
            display: table-row !important;
            page-break-inside: avoid;
            border-left: hidden;
            border-right : hidden;
            border-top : 1px black solid;
            border-bottom : 1px black solid;
            }
            .act_as_cell_personal {
            display: table-cell !important;
            page-break-inside: avoid;
            border-left: hidden;
            border-right : hidden;
            }
            .act_as_row_table_body {
            display: table-row !important;
            page-break-inside: avoid;
            border: hidden;
            }
            .act_as_cell_table_body {
            display: table-cell !important;
            page-break-inside: avoid;
            border: hidden;
            }
        </style>
        <div class="header">
            <t t-set="title">
                <t t-raw="company_name"/>
            </t>
            <t t-set="subtitle">
                LIBRO DIARIO MAYOR
                <br/>
                PERIODO DEL:
                <span t-esc="date_from"/>
                AL:
                <span t-esc="date_to"/>
                <br/>
                CIFRAS EXPRESADAS EN DOLARES DE ESTADOS UNIDOS DE NORTEAMERICA
            </t>
            <div class="row w-100">
                <h3
                        class="mt0 w-100"
                        t-esc="title"
                        style="text-align: center;"
                />
            </div>
            <div class="row w-100">
                <p
                        class="mt0 w-100"
                        t-esc="subtitle"
                        style="text-align: center;"
                />
            </div>
            <div class="act_as_table_personal data_table" style="width: 100%;">
                <!-- Display table headers for lines -->
                <div class="act_as_thead">
                    <div class="act_as_row_personal labels">
                        <!--## Numero de cuenta/ No. Poliza-->
                        <div class="act_as_cell_personal" style="width: 5%;">NÂ° CUENTA</div>
                        <!--## date-->
                        <div class="act_as_cell_personal" style="width: 10%;">FECHA</div>
                        <!--## Nombre-->
                        <div class="act_as_cell_personal" style="width: 25%">NOMBRE
                            <br/>
                            MOVIMIENTOS DEL MES
                        </div>
                        <!--## SALDO INICIAL-->
                        <div class="act_as_cell_personal" style="width: 10%;">SALDO<br/>INICIAL
                        </div>
                        <!--## CARGOS-->
                        <div class="act_as_cell_personal" style="width: 10%;">CARGOS</div>
                        <!--## ABONOS-->
                        <div class="act_as_cell_personal" style="width: 10%;">ABONOS</div>
                        <!--## SALDO MES
                        <div class="act_as_cell_personal" style="width: 15%;">SALDO<br/>MES</div>
                        ## SALDO FINAL-->
                        <div class="act_as_cell_personal" style="width: 15%;">SALDO<br/>FINAL
                        </div>
                    </div>
                </div>
            </div>
            <style>
                .act_as_table_personal {
                display: table !important;
                }
                .act_as_row_personal {
                display: table-row !important;
                page-break-inside: avoid;
                border-left: hidden !important;
                border-right : hidden !important;
                border-top : 1px black solid;
                border-bottom : 1px black solid;
                }
                .act_as_cell_personal {
                display: table-cell !important;
                page-break-inside: avoid;
                border-left: hidden;
                border-right : hidden;
                }
                .data_table{
                width: 100% !important;
                border-left: 0px;
                border-right: 0px;
                text-align: center;
                font-size: 10px;
                padding-right: 3px;
                padding-left: 3px;
                padding-top: 2px;
                padding-bottom: 2px;
                border-collapse: collapse;
                border: 1px solid lightGrey;
                text-align: center;
                word-wrap: break-word;
                font-weight: bold;
                }
                .act_as_thead {
                display: table-header-group !important;
                }
                labels {
                background-color: #f0f0f0 !important;
                border-color: grey !important;
                border-bottom: 1px solid lightGrey !important;
                font-weight: bold;
                }
            </style>
        </div>
        <div class="page">
            <t t-foreach="general_ledger" t-as="account">
                <div class="page_break">
                    <div class="act_as_table list_table" style="margin-top: 10px;"/>
                    <!-- -->
                    <t t-call="account_financial_report.report_libro_diario_mayor_lines">
                        <t t-set="account_or_partner_object" t-value="account"/>
                    </t>
                </div>
            </t>
        </div>
    </template>
    <template id="account_financial_report.report_libro_diario_mayor_lines">
        <div class="act_as_table_personal data_table" style="width: 100%;">
            <!-- Display first line with initial balance -->
            <div class="act_as_row_table_body">
                <!--## No Cuenta-->
                <div class="act_as_cell_table_body" style="width: 5%;font-weight: bold;">
                    <span t-esc="o._get_atr_from_dict(account['id'], accounts_data, 'code')"/>
                </div>
                <!--## Fecha-->
                <div class="act_as_cell_table_body" style="width: 10%;"/>
                <!--## Nombre-->
                <div class="act_as_cell_table_body" style="width: 25%;font-weight: bold;">
                    <span t-esc="o._get_atr_from_dict(account['id'], accounts_data, 'name')"/>
                </div>
                <!--## Saldo Inicial-->
                <div class="act_as_cell_table_body amount" style="width: 10%;font-weight: bold;">
                    <span
                            t-raw="abs(account_or_partner_object['init_bal']['balance'])"
                            t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
                <!--## debit-->
                <div class="act_as_cell_table_body amount" style="width: 10%;font-weight: bold;">
                    <t t-if="abs(account_or_partner_object['init_bal']['debit'])>0">
                        <span
                                t-esc="abs(account_or_partner_object['init_bal']['debit'] - account_or_partner_object['fin_bal']['debit'])"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                        />
                    </t>
                    <t t-else="">
                        <span
                                t-esc="abs(abs(account_or_partner_object['fin_bal']['debit']))"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                        />
                    </t>
                </div>
                <!--## credit-->
                <div class="act_as_cell_table_body amount" style="width: 10%;font-weight: bold;">
                    <t t-if="abs(account_or_partner_object['init_bal']['credit'])>0">
                        <span
                                t-esc="abs(account_or_partner_object['init_bal']['credit'] - account_or_partner_object['fin_bal']['credit'])"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                        />
                    </t>
                    <t t-else="">
                        <span
                                t-esc="abs(account_or_partner_object['fin_bal']['credit'])"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                        />
                    </t>
                </div>
                <!--## Saldo mes

                <div class="act_as_cell_table_body amount" style="width: 15%;font-weight: bold;">
                    <t t-if="abs(account_or_partner_object['init_bal']['debit'])>0">
                        <span
                                t-esc="(abs(account_or_partner_object['init_bal']['debit'] - account_or_partner_object['fin_bal']['debit']) - account_or_partner_object['fin_bal']['credit'])"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                        />
                    </t>
                    <t t-else="">
                        <t t-if="abs(account_or_partner_object['init_bal']['credit'])>0">
                            <span
                                    t-esc="(account_or_partner_object['fin_bal']['debit'] - abs(account_or_partner_object['init_bal']['credit'] - account_or_partner_object['fin_bal']['credit']))"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </t>
                        <t t-else="">
                            <span
                                    t-esc="(account_or_partner_object['fin_bal']['debit'] - account_or_partner_object['fin_bal']['credit'])"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </t>
                    </t>
                </div>

                ## Saldo Final-->
                <div class="act_as_cell_table_body amount" style="width: 15%;font-weight: bold;">
                    <t t-set="code" t-value="o._get_atr_from_dict(account['id'], accounts_data, 'code')" />
                    <t t-if=" code[0:1] == '2' or code[0:1] == '3' or code[0:1] == '5'">
                        <span
                                t-esc="-1*(account_or_partner_object['fin_bal']['balance'])"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"

                        />
                    </t>
                    <t t-else="">
                        <span
                                t-esc="account_or_partner_object['fin_bal']['balance']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"

                        />
                    </t>
                </div>
            </div>
            <!-- Display each lines -->
            <t t-foreach="account_or_partner_object['move_lines']" t-as="line">
                <!-- # lines or centralized lines -->
                <div class="act_as_row_table_body lines">
                    <!--## No cuenta-->
                    <div class="act_as_cell_table_body" style="width: 5%;">Eg</div>
                    <!--## date-->
                    <div class="act_as_cell_table_body left" style="width: 10%;">
                        <t t-if="line['id']">
                            <!--## We don't use t-field because it throws an error on click -->
                            <span
                                    t-att-res-id="line['id']"
                                    res-model="account.move.line"
                                    view-type="form"
                            >
                                <t
                                        t-esc="line['date']"
                                        t-options="{'widget': 'date'}"
                                />
                            </span>
                        </t>
                        <t t-else="">
                            <span>
                                <!--## We don't use t-field because it throws an error on click -->
                                <t
                                        t-esc="line['date']"
                                        t-options="{'widget': 'date'}"
                                />
                            </span>
                        </t>
                    </div>
                    <!--## Movimiento del mes-->
                    <div class="act_as_cell_table_body left" style="width: 25%">
                        <t t-if="line['entry_id']">
                            <span
                                    t-att-res-id="line['entry_id']"
                                    res-model="account.move"
                                    view-type="form"
                            >
                                <t t-raw="line['entry']"/>
                            </span>
                        </t>
                    </div>
                    <!--## Saldo inicial-->
                    <div class="act_as_cell_table_body left" style="width: 10%;"/>
                    <!--## Cargos-->
                    <div class="act_as_cell_table_body amount" style="width: 10%;">
                        <t t-if="line['id']">
                            <span
                                    t-att-res-id="line['id']"
                                    res-model="account.move.line"
                                    view-type="form"
                            >
                                <t
                                        t-raw="line['debit']"
                                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </span>
                        </t>
                        <t t-else="">
                            <span>
                                <t
                                        t-raw="line['debit']"
                                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </span>
                        </t>
                    </div>
                    <!--## Abonos-->
                    <div class="act_as_cell_table_body amount" style="width: 10%;">
                        <t t-if="line['id']">
                            <span
                                    t-att-res-id="line['id']"
                                    res-model="account.move.line"
                                    view-type="form"
                            >
                                <t
                                        t-raw="line['credit']"
                                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </span>
                        </t>
                        <t t-else="">
                            <span>
                                <t
                                        t-raw="line['credit']"
                                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </span>
                        </t>
                    </div>
                    <!--## Saldo mes
                    <div class="act_as_cell_table_body amount" style="width: 15%;"/>
                    ## Saldo final-->
                    <div class="act_as_cell_table_body amount" style="width: 15%;"/>
                </div>
            </t>
        </div>
    </template>
</odoo>